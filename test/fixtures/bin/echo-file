#!/usr/bin/env node

/**
 *
 * This program writes the contents of the specified file to stdout
 *
 */
'use strict';

const fs = require('fs');

let stdOutFiles = [];
let stdErrFiles = [];

let errorFlag = false;
let filesNotFound = false;

for (let i = 2; i < process.argv.length; i++) {
  if (process.argv[i] === '--error') {
    errorFlag = true;
  }
  else {
    if (errorFlag) {
      stdErrFiles.push(process.argv[i]);
    }
    else {
      stdOutFiles.push(process.argv[i]);
    }
  }
}

if (stdOutFiles.length === 0 && stdErrFiles.length === 0) {
  console.error('No file name was specified');
  process.exit(1);
}

for (let stdOutFile of stdOutFiles) {
  if (!fs.existsSync(stdOutFile)) {
    console.error(`Unable to find file: ${stdOutFile}`);
    filesNotFound = true;
  }
  let data = fs.readFileSync(stdOutFile);
  process.stdout.write(data);
}

for (let stdErrFile of stdErrFiles) {
  if (!fs.existsSync(stdErrFile)) {
    console.error(`Unable to find file: ${stdErrFile}`);
    filesNotFound = true;
  }
  let data = fs.readFileSync(stdErrFile);
  process.stderr.write(data);
}

if (filesNotFound) {
  process.exit(2);
}
